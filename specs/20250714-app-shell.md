# AppShell追加 仕様書

**タスク名**: AppShell追加
**作成日時**: 2025-07-14 10:35:00
**ブランチ名**: feature/app-shell

## 1. タスクの目的・背景

現在のアプリケーションはページごとに個別にナビゲーションが実装されており、一貫したレイアウトとナビゲーション体験が提供できていません。MantineのAppShellコンポーネントを導入することで、統一されたアプリケーション構造とナビゲーションを実現し、ユーザビリティを向上させる必要があります。

## 2. 具体的な要件

### 実装する機能
- Mantine AppShellを使用した統一レイアウト
- ヘッダー（認証状態表示、ユーザーメニュー）
- サイドナビゲーション（主要ページへのリンク）
- メインコンテンツエリア
- レスポンシブ対応（モバイル対応）

### ユーザー操作
- サイドバーからページ間の移動
- ヘッダーの認証ボタンでログイン/ログアウト
- モバイルでのハンバーガーメニュー操作

### 入力・出力
- **入力**: ナビゲーションクリック、認証アクション
- **出力**: ページ遷移、レイアウト変更、認証状態表示

## 3. 技術的制約・考慮事項

### 既存コードベース
- 現在の `app/layout.tsx` を拡張
- 既存の `AuthButton` コンポーネントを活用
- Next.js App Routerとの互換性を保持

### パフォーマンス
- Server Componentsを活用した最適化
- Suspense境界の適切な配置

### セキュリティ
- 認証状態に応じたナビゲーション表示制御
- 管理者専用ページへのアクセス制御

## 4. 実装方針

### アプローチ
- Mantine AppShellコンポーネントを使用
- Container/Presentationパターンを採用
- 既存レイアウトの段階的移行

### 使用技術
- Mantine AppShell, Header, Navbar, Burger
- Next.js App Router
- TypeScript

### ファイル構成
```
src/app/_components/AppShell/
├── AppShellContainer.tsx      # Server Component
├── AppShellPresentation.tsx   # Client Component  
├── AppShellPresentation.test.tsx
└── index.ts
```

## 5. テスト戦略

### 必要なテスト
- AppShell基本表示テスト
- ナビゲーションリンクの動作テスト
- 認証状態による表示変更テスト
- レスポンシブ動作テスト

### 具体的テストケース
1. **基本表示テスト**
   - ヘッダーとサイドバーが正しく表示される
   - AppShellの基本構造が適切に配置される

2. **ナビゲーションテスト**
   - ナビゲーションリンクが適切に動作する
   - アクティブページのハイライト表示

3. **認証状態テスト**
   - 認証済み/未認証でメニュー内容が変わる
   - 管理者ユーザーのみ管理メニューが表示される

4. **インタラクションテスト**
   - モバイルでハンバーガーメニューが機能する
   - サイドバーの開閉動作

### エッジケース
- 認証状態の変更時の表示更新
- 長いユーザー名の表示処理
- ナビゲーション項目の多い場合のスクロール
- 画面サイズ変更時のレスポンシブ動作